<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
  <meta charset="UTF-8">
  <title>Tableau de Voyage</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }

    .logo-container {
      text-align: center;
      margin-bottom: 15px;
    }
    
      input#workingDays {
      transition: background-color 0.3s ease;
    }


    .logo {
      max-width: 180px;
      height: auto;
      display: inline-block;
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    label, input {
      display: block;
      width: 50%;
      margin: 10px 0;
      font-size: 18px;
    }

    textarea {
      width: 100%;
      font-size: 16px;
      margin: 10px 0;
      padding: 30px 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      resize: vertical;
      text-align: center;
      box-sizing: border-box;
      font-family: 'Tajawal', 'Arial', sans-serif;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
    }
	
	#resultTable thead th {
		background-color: #fff9c4; /* Ø£ØµÙØ± ÙØ§ØªØ­ */
		color: #000;               /* ÙƒØªØ§Ø¨Ø© Ø³ÙˆØ¯Ø§Ø¡ */
	}

    tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    button {
      margin-top: 15px;
      padding: 10px 20px;
      background: #0066cc;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 22px;
    }

    button:hover {
      background-color: #0051a3;
    }

    .lang-switch {
      text-align: right;
      margin-bottom: 10px;
    }

    .warning {
      background-color: #fff3cd;
      color: #856404;
      padding: 10px;
      border-radius: 6px;
      margin-top: 10px;
    }

    .button-row {
     display: flex;
    justify-content: center;
    flex-wrap: nowrap;
    gap: 10px;
    align-content: center;
    align-items: center;
    }

    @media print {
      @page {
        size: A4 landscape;
        margin: 10mm;
      }

      body {
        background: white;
        color: black;
        margin: 0;
        padding: 0;
      }

      .container {
        box-shadow: none;
        padding: 0;
        margin: 0;
        border-radius: 0;
        max-width: 100%;
      }

      .lang-switch,
      .warning,
      .button-row,
      input,
      label,
      #printNote {
        display: none !important;
      }

      #customNote {
        display: block !important;
        border: none;
        font-size: 16px;
        width: 100%;
        height: auto;
        resize: none;
        text-align: center;
        padding: 30px 10px;
      }

      .logo-container {
        display: block !important;
        text-align: center;
        margin-bottom: 10px;
      }

      .logo {
        max-width: 150px;
        height: auto;
      }

      table {
        page-break-inside: avoid;
      }

      h2 {
        margin: 0 0 10px 0;
        text-align: center;
      }
    }

@media print {
  .logo-container,
  .logo,
  #customNote,
  #resultTable {
    page-break-before: avoid;
    page-break-after: avoid;
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
 /* Ø¥Ø®ÙØ§Ø¡ Ø¹Ù…ÙˆØ¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
  .download-column,
  .download-button {
    display: none !important;
  }

  /* Ù…Ø³Ø§ÙØ© 0.8 Ø³Ù†ØªÙŠÙ…ØªØ± Ø¨ÙŠÙ† Remarques ÙˆØ§Ù„Ø¬Ø¯ÙˆÙ„ */
  #customNote {
    margin-bottom: 8.8cm !important;
    padding-bottom: 0 !important;
  }

  #resultTable {
    margin-top: 0 !important;
  }

  .logo {
    max-height: 100px !important;
    height: auto !important;
    display: block;
    margin: 0 auto;
  }

  .logo-container {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }

  #customNote {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }

  #resultTable {
    margin-top: 0 !important;
  }
}


  </style>
</head>
<body>
  <div class="container">
    <div class="lang-switch">
      <button onclick="switchLanguage()">ğŸ‡«ğŸ‡· / ğŸ‡¸ğŸ‡¦</button>
    </div>

<center>

    <div class="logo-container">
      <img src="Logo_of_the_Bank_of_Algeria.png" alt="Logo" class="logo">
    </div>
	
	
    <h2 id="title">Tableau de Paiement des Frais de Change</h2>

    <label id="labelStart">Date de dÃ©but:</label>
    <input type="date" id="startDate">

    <label id="labelEnd">Date de fin:</label>
    <input type="date" id="endDate">

    <label id="labelDays">Nombre de jours ouvrables:</label>
    <input type="number" id="workingDays" min="1" max="90" value="3">
	<label><input type="checkbox" id="includeWeekends">Ø¹Ø¯Ù… Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ø¬Ù…Ø¹Ø© ÙˆØ§Ù„Ø³Ø¨ØªØŸ</label>


    <div class="warning" id="warningText">ğŸ’¡ Valeur recommandÃ©e par la banque: 3</div>

    <div class="button-row">
      <button onclick="generateTable()" id="btnGenerate">GÃ©nÃ©rer</button>
      <button onclick="clearTable()" id="btnClear">Vider</button>
      <button onclick="printPage()" id="btnPrint">Imprimer</button>
    </div>

</center>

    <label id="labelNote">Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</label>
    <textarea id="customNote" rows="3" placeholder="...Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ùˆ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"></textarea>

    <table id="resultTable">
      <thead>
        <tr>
          <th>Date de paiement</th>
          <th>Date de voyage 1</th>
          <th>Date de voyage 2</th>
          <th>Date de voyage 3</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
	
    const labels = {
      fr: {
        title: "Tableau de Paiement des Frais de Change",
        labelStart: "Date de dÃ©but:",
        labelEnd: "Date de fin:",
        labelDays: "Nombre de jours ouvrables:",
        labelNote: "Remarques:",
        warning: "ğŸ’¡ Valeur recommandÃ©e par la banque: 3",
        headers: ["Date de paiement", "Date de voyage 1", "Date de voyage 2", "Date de voyage 3"],
        buttons: { generate: "GÃ©nÃ©rer", clear: "Vider", print: "Imprimer" }
      },
      ar: {
        title: "Ø¬Ø¯ÙˆÙ„ Ù„ØªØ³Ø¯ÙŠØ¯ Ø­Ù‚ Ø§Ù„ØµØ±Ù",
        labelStart: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡:",
        labelEnd: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:",
        labelDays: "Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„:",
        labelNote: "Ù…Ù„Ø§Ø­Ø¸Ø§Øª:",
        warning: "ğŸ’¡ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§ Ù…Ù† Ø§Ù„Ø¨Ù†Ùƒ: 3",
        headers: ["ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³ÙØ± 1", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³ÙØ± 2", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³ÙØ± 3"],
        buttons: { generate: "ØªÙˆÙ„ÙŠØ¯", clear: "ØªÙØ±ÙŠØº", print: "Ø·Ø¨Ø§Ø¹Ø©" }
      }
    };

    let currentLang = 'fr';

window.onload = function () {
  const today = new Date();
  const nextMonthStart = new Date(today.getFullYear(), today.getMonth() + 1, 1);
  const nextMonthEnd = new Date(today.getFullYear(), today.getMonth() + 2, 0);

  const formatDate = (d) => d.toISOString().split('T')[0];

  document.getElementById("startDate").value = formatDate(nextMonthStart);
  document.getElementById("endDate").value = formatDate(nextMonthEnd);

  // --- Ù‡Ù†Ø§ ÙƒÙˆØ¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø© ---
  const workingDaysInput = document.getElementById("workingDays");

  function updateWorkingDaysColor() {
    if (parseInt(workingDaysInput.value) === 3) {
      workingDaysInput.style.backgroundColor = "#c8e6c9"; // Ø£Ø®Ø¶Ø± ÙØ§ØªØ­
    } else {
      workingDaysInput.style.backgroundColor = "#ffcdd2"; // Ø£Ø­Ù…Ø± ÙØ§ØªØ­
    }
  }

  workingDaysInput.addEventListener("input", updateWorkingDaysColor);
  updateWorkingDaysColor();
};

	
    function switchLanguage() {
      currentLang = currentLang === 'fr' ? 'ar' : 'fr';
      document.getElementById("title").innerText = labels[currentLang].title;
      document.getElementById("labelStart").innerText = labels[currentLang].labelStart;
      document.getElementById("labelEnd").innerText = labels[currentLang].labelEnd;
      document.getElementById("labelDays").innerText = labels[currentLang].labelDays;
      document.getElementById("warningText").innerText = labels[currentLang].warning;
      document.getElementById("labelNote").innerText = labels[currentLang].labelNote;

      const headerCells = document.querySelectorAll("#resultTable thead tr th");
      labels[currentLang].headers.forEach((text, i) => {
        headerCells[i].innerText = text;
      });

      document.getElementById("btnGenerate").innerText = labels[currentLang].buttons.generate;
      document.getElementById("btnClear").innerText = labels[currentLang].buttons.clear;
      document.getElementById("btnPrint").innerText = labels[currentLang].buttons.print;

      document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
      document.documentElement.lang = currentLang;
    }

    function isWorkingDay(date) {
      const day = date.getDay();
      return day !== 5 && day !== 6;
    }

    function addWorkingDays(start, days) {
      let result = new Date(start);
      let added = 0;
      while (added < days) {
        result.setDate(result.getDate() + 1);
        if (isWorkingDay(result)) {
          added++;
        }
      }
      return result;
    }

    function formatDateLocalized(date) {
      if (currentLang === 'ar') {
        const jours = ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø§Ù„Ø³Ø¨Øª"];
        const mois = ["Ø¬Ø§Ù†ÙÙŠ", "ÙÙŠÙØ±ÙŠ", "Ù…Ø§Ø±Ø³", "Ø£ÙØ±ÙŠÙ„", "Ù…Ø§ÙŠ", "Ø¬ÙˆØ§Ù†", "Ø¬ÙˆÙŠÙ„ÙŠØ©", "Ø£ÙˆØª", "Ø³Ø¨ØªÙ…Ø¨Ø±", "Ø£ÙƒØªÙˆØ¨Ø±", "Ù†ÙˆÙÙ…Ø¨Ø±", "Ø¯ÙŠØ³Ù…Ø¨Ø±"];
        return `${jours[date.getDay()]}ØŒ ${date.getDate()} ${mois[date.getMonth()]} ${date.getFullYear()}`;
      } else {
        const jours = ["Dimanche", "Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"];
        const mois = ["janvier", "fÃ©vrier", "mars", "avril", "mai", "juin", "juillet", "aoÃ»t", "septembre", "octobre", "novembre", "dÃ©cembre"];
        return `${jours[date.getDay()]}, ${date.getDate()} ${mois[date.getMonth()]} ${date.getFullYear()}`;
      }
    }
	
	function isWeekend(day) {
  return day === 5 || day === 6; // Ø§Ù„Ø¬Ù…Ø¹Ø© = 5ØŒ Ø§Ù„Ø³Ø¨Øª = 6
}



function addConditionalDays(start, totalDays, includeWeekends) {
  let result = new Date(start);
  let added = 0;
  while (added < totalDays) {
    result.setDate(result.getDate() + 1);
    const day = result.getDay();
    if (includeWeekends || (!isWeekend(day))) {
      added++;
    }
  }
  return result;
}

function generateTable() {
  const start = new Date(document.getElementById("startDate").value);
  const end = new Date(document.getElementById("endDate").value);
  const days = parseInt(document.getElementById("workingDays").value);
  const includeWeekends = document.getElementById("includeWeekends")?.checked;

  const tbody = document.querySelector("#resultTable tbody");
  tbody.innerHTML = "";

  if (isNaN(start) || isNaN(end) || days < 1 || days > 90) {
    alert(currentLang === 'fr' ? "Veuillez entrer des donnÃ©es valides." : "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø©.");
    return;
  }

  for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
    const current = new Date(d);
    if (!isWorkingDay(current)) continue;

    const voyage1 = addConditionalDays(current, days, includeWeekends);

    const voyage2 = new Date(voyage1);
    voyage2.setDate(voyage2.getDate() + 1);

    const voyage3 = new Date(voyage2);
    voyage3.setDate(voyage3.getDate() + 1);

    const row = document.createElement("tr");
    [current, voyage1, voyage2, voyage3].forEach(date => {
      const td = document.createElement("td");
      td.innerText = formatDateLocalized(date);
      row.appendChild(td);
    });

    tbody.appendChild(row);
  }
}






    function clearTable() {
      document.querySelector("#resultTable tbody").innerHTML = "";
    }

    function printPage() {
      if (document.querySelector("#resultTable tbody").children.length === 0) {
        alert(currentLang === 'fr' ? "Aucun tableau Ã  imprimer." : "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¬Ø¯ÙˆÙ„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©.");
        return;
      }
      alert(
        currentLang === 'fr'
          ? "â„¹ï¸ Pour une impression propre, dÃ©sactivez lâ€™option 'En-tÃªtes et pieds de page' dans la fenÃªtre d'impression."
          : "â„¹ï¸ Ù„ØªÙØ§Ø¯ÙŠ Ø¸Ù‡ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ø³ÙÙ„ Ø§Ù„ÙˆØ±Ù‚Ø©ØŒ Ù‚Ù… Ø¨Ø¥Ù„ØºØ§Ø¡ Ø®ÙŠØ§Ø± 'Ø±Ø¤ÙˆØ³ ÙˆØªØ°ÙŠÙŠÙ„Ø§Øª Ø§Ù„ØµÙØ­Ø©' Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø§Ø¨Ø¹Ø©."
      );
      window.print();
    }
  </script>
</body>
</html>
